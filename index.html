<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>éŠæˆ²æ¨¡æ¿å•Ÿå‹•å™¨</title>
<style>
  :root{
    --bg:#0b1020; --panel:#131a2e; --ink:#e9ecf5; --muted:#9fb0d6;
    --accent:#6ad1ff; --ok:#66e3a0; --warn:#ffd36a; --danger:#ff6b6b;
  }
  html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg),#0e1630);}
  body{font-family: system-ui, -apple-system, "Noto Sans TC", Segoe UI, Roboto, Arial, "PingFang TC", "Microsoft JhengHei", sans-serif; color:var(--ink); display:flex; align-items:center; justify-content:center; padding:20px;}
  .shell{width:min(920px,100%); background:rgba(19,26,46,.8); border:1px solid #1f2a4a; border-radius:16px; box-shadow:0 10px 40px rgba(0,0,0,.35); overflow:hidden;}
  header{padding:18px 20px; border-bottom:1px solid #1f2a4a; display:flex; gap:10px; align-items:center; justify-content:space-between;}
  header h1{font-size:18px; margin:0; letter-spacing:.5px}
  header .meta{font-size:13px; color:var(--muted)}
  main{padding:18px;}
  .toolbar{display:flex; gap:8px; flex-wrap:wrap; margin-bottom:16px}
  button{background:#1a2444; color:var(--ink); border:1px solid #2a3968; padding:10px 14px; border-radius:12px; cursor:pointer}
  button:hover{background:#1f2b52}
  .pill{font-size:12px; padding:6px 10px; border-radius:999px; background:#19213e; border:1px solid #2a3968; color:var(--muted)}
  .grid{display:grid; gap:12px}
  .center{display:flex; align-items:center; justify-content:center}
  .card{background:#101733; border:1px solid #1f2a4a; border-radius:12px; padding:14px}
  .big{font-size:24px; text-align:center}
  /* Puzzle (memory) */
  .board{display:grid; gap:10px; justify-content:center}
  .tile{width:72px; height:72px; background:#121b3a; border:1px solid #2a3968; border-radius:10px; display:flex; align-items:center; justify-content:center; font-size:28px; cursor:pointer; transform:translateZ(0); transition:transform .12s}
  .tile.revealed{background:#1a2448}
  .tile.matched{background:#173a2a; border-color:#2d5b47}
  /* Riddle */
  .riddle-q{font-weight:700; margin-bottom:8px}
  .choice{padding:10px 12px; border-radius:10px; border:1px solid #2a3968; cursor:pointer; margin:6px 0; background:#141c3a}
  .choice.correct{outline:2px solid var(--ok)}
  .choice.wrong{outline:2px solid var(--danger)}
  /* Story */
  .story{line-height:1.7}
  .story .opt{margin-top:10px}
  /* Relax */
  .bubble{width:220px; height:220px; border-radius:50%; background:radial-gradient(circle at 30% 30%, #7fe4ff, #215a86); box-shadow:0 0 40px rgba(106,209,255,.4) inset, 0 0 24px rgba(106,209,255,.3)}
  .hint{color:var(--muted); font-size:14px; text-align:center; margin-top:10px}
  .footer{padding:14px 20px; border-top:1px solid #1f2a4a; display:flex; align-items:center; justify-content:space-between; color:var(--muted); font-size:12px}
  .hidden{display:none!important}
</style>
</head>
<body>
<div class="shell">
  <header>
    <h1 id="title">éŠæˆ²æ¨¡æ¿</h1>
    <div class="meta" id="subtitle"></div>
  </header>
  <main>
    <div class="toolbar">
      <span class="pill" id="genre-pill"></span>
      <button id="btn-restart">é‡æ–°é–‹å§‹</button>
    </div>
    <div id="mount"></div>
  </main>
  <div class="footer">
    <div>Â© Template Kit</div>
    <div id="footer-status">æº–å‚™å°±ç·’</div>
  </div>
</div>

<!-- ======== åªè¦æ”¹é€™æ®µ CONFIGï¼Œå°±èƒ½å¿«é€Ÿå‡º 4 ç¨®éŠæˆ² ======== -->
<script>
const CONFIG = {
  gameType: "puzzle", // "puzzle" | "riddle" | "story" | "relax"
  title: "è…¦åŠ›å°åŠ‡å ´",
  subtitle: "æ”¹ä¸Šé¢çš„ gameType å³å¯åˆ‡æ›ä¸åŒæ¨¡æ¿",
  palette: { bg:"#0b1020", accent:"#6ad1ff" },
  locale: "zh-TW",
  difficulty: "normal", // "easy" | "normal" | "hard"
  // é¡Œåº«/æ–‡æœ¬ â€”â€” å¯ä»¥è®“ ChatGPT æ¨¡çµ„å‹•æ…‹ç”¢ç”Ÿ
  riddleBank: [
    { q:"ä»€éº¼æ±è¥¿è¶Šæ´—è¶Šé«’ï¼Ÿ", a:["æ°´","æ¯›å·¾","è‚¥çš‚"], correct:1, explain:"æ¯›å·¾ç”¨ä¾†æ“¦æ‹­ï¼Œè¶Šæ“¦è¶Šé«’ã€‚" },
    { q:"ä»€éº¼é–€æ°¸é é—œä¸ä¸Šï¼Ÿ", a:["è»Šé–€","çƒé–€","çª—é–€"], correct:1, explain:"çƒé–€æ¯”è³½ç”¨ï¼Œæ²’æœ‰é–€æ‰‡ã€‚" },
    { q:"ä»€éº¼äººæ—©ä¸Šå››éš»è…³ï¼Œä¸­åˆå…©éš»è…³ï¼Œæ™šä¸Šä¸‰éš»è…³ï¼Ÿ", a:["äºº","ç‹—","å¤–æ˜Ÿäºº"], correct:0, explain:"å¬°å…’çˆ¬è¡Œã€æˆäººè¡Œèµ°ã€è€å¹´æ‹æ–ã€‚" }
  ],
  storyNodes: {
    start: { text:"ä½ åœ¨éœ§æ—é†’ä¾†ï¼Œå£è¢‹è£¡åªæœ‰ä¸€å¼µåœ°åœ–èˆ‡ä¸€æšéŠ…å¹£ã€‚å‰æ–¹æœ‰å…©æ¢è·¯ï¼šå·¦é‚Šæœˆå…‰æ·¡è—ï¼Œå³é‚Šå¾®é¢¨æ¸…é³´ã€‚",
      options:[ {t:"èµ°å‘æœˆå…‰", go:"moon"}, {t:"è¿½è‘—æ¸…é³´", go:"wind"} ] },
    moon: { text:"æœˆå…‰æ˜ å‡ºä¸€åº§å¤äº•ã€‚äº•æ—åˆ»è‘—ï¼šã€Œä»¥ç•¶ä¸‹ä¹‹å¿ƒï¼Œæ›æœªä¾†ä¹‹å®‰ã€‚ã€",
      options:[ {t:"æŠ•å…¥éŠ…å¹£", go:"well"}, {t:"ç¹é“é›¢é–‹", go:"camp"} ] },
    wind: { text:"é¢¨å¸¶ä¾†é è™•çš„ç¬‘è²ï¼Œæ˜¯æ—…äººçš„ç‡Ÿåœ°ã€‚",
      options:[ {t:"å‰å¾€ç‡Ÿåœ°", go:"camp"}, {t:"æŠ˜è¿”è§€äº•", go:"moon"} ] },
    well: { text:"äº•ä¸­å‚³ä¾†å›éŸ¿ï¼šã€è¦åŠƒç•¶ä¸‹ï¼Œæ–¹å¾—å¾å®¹ã€‚ã€ä½ ç²å¾—ã€å¾å®¹ã€‘å±¬æ€§ï¼Œæ—…é€”æ›´ç©©å®šã€‚",
      end:"æ­å–œï¼Œä½ ä»¥å†·éœèˆ‡è¦åŠƒç©¿è¶Šè¿·éœ§ï¼Œæ‰¾åˆ°å›å®¶çš„è·¯ã€‚" },
    camp: { text:"ç‡Ÿç«é‚Šçš„æ—…äººåˆ†äº«åœ°åœ–æ¨™è¨˜ï¼šã€åˆ¥æ€•æ”¹è®Šè·¯ç·šï¼Œåªè¦ä¿ç•™é¤˜è£•ã€‚ã€",
      end:"ä½ å­¸æœƒé ç•™é¤˜è£•ï¼Œæ—…ç¨‹é›–æœ‰æ³¢æŠ˜å»å®‰ç„¶æŠµé”ã€‚" }
  },
  relax: {
    cycleSec: 8, // å¸æ°£ 4s + åæ°£ 4s
    tips: ["å¸æ°£â€¦","åœâ€¦","åæ°£â€¦","åœâ€¦"],
    durationSec: 60
  },
  puzzle: {
    symbols: ["ğŸ€","â­","ğŸŒ™","ğŸ”¥","ğŸ’§","ğŸ‹","ğŸ§©","ğŸ§","âš¡","ğŸŒ¸"],
  }
};
</script>
<!-- ======================================================== -->

<script>
/* ===== Core Framework ===== */
const $ = (sel, el=document)=>el.querySelector(sel);
const mount = $("#mount");
const setText = (id, txt)=>{ const el = document.getElementById(id); if(el) el.textContent = txt; };
const setStatus = (txt)=> setText("footer-status", txt);
const setGenre = (t)=> setText("genre-pill", "æ¨¡å¼ï¼š" + t);

function applyTheme(){
  if(CONFIG.palette?.bg) document.documentElement.style.setProperty('--bg', CONFIG.palette.bg);
  if(CONFIG.palette?.accent) document.documentElement.style.setProperty('--accent', CONFIG.palette.accent);
  setText("title", CONFIG.title || "éŠæˆ²æ¨¡æ¿");
  setText("subtitle", CONFIG.subtitle || "");
}

function clearMount(){ mount.innerHTML=""; }

/* ====== Games ====== */
// 1) Puzzle â€” è¨˜æ†¶ç¿»ç‰Œ
function gamePuzzle(){
  setGenre("ç›Šæ™ºï¼ˆç¿»ç‰Œè¨˜æ†¶ï¼‰");
  clearMount();
  const wrap = document.createElement("div");
  wrap.className = "grid";
  const top = document.createElement("div"); top.className="card";
  const info = document.createElement("div"); info.innerHTML = "é…å°æˆåŠŸï¼š<b id='okc'>0</b>";
  top.appendChild(info); wrap.appendChild(top);

  const board = document.createElement("div"); board.className="board";
  const pairs = CONFIG.difficulty==="hard"?10:CONFIG.difficulty==="easy"?6:8;
  const pool = CONFIG.puzzle.symbols.slice(0,pairs);
  const deck = [...pool, ...pool].sort(()=>Math.random()-0.5);
  const state = { first:null, lock:false, matched:0 };
  board.style.gridTemplateColumns = `repeat(${Math.sqrt(deck.length)%1?4:Math.sqrt(deck.length)}, 72px)`;

  deck.forEach((sym,i)=>{
    const t = document.createElement("button");
    t.className="tile"; t.dataset.i=i; t.dataset.sym=sym; t.textContent="â”";
    t.addEventListener("click", ()=>{
      if(state.lock || t.classList.contains("revealed")) return;
      t.classList.add("revealed"); t.textContent = sym;
      if(!state.first){ state.first = t; return; }
      // second
      if(state.first.dataset.sym===t.dataset.sym && state.first!==t){
        [state.first, t].forEach(e=>{ e.classList.add("matched"); e.style.pointerEvents="none"; });
        state.matched++; $("#okc").textContent = state.matched;
        if(state.matched===pairs){ setStatus("å…¨éƒ¨é…å°å®Œæˆï¼"); }
        state.first=null;
      }else{
        state.lock=true;
        setTimeout(()=>{
          [state.first, t].forEach(e=>{ e.classList.remove("revealed"); e.textContent="â”"; });
          state.first=null; state.lock=false;
        }, 700);
      }
    });
    board.appendChild(t);
  });

  wrap.appendChild(board);
  mount.appendChild(wrap);
  setStatus("ç¿»å…©å¼µæ‰¾ä¸€å°");
}

// 2) Riddle â€” çŒœè¬é—–é—œ
function gameRiddle(){
  setGenre("è§£è¬ï¼ˆçŒœè¬ï¼‰");
  clearMount();
  const bank = CONFIG.riddleBank;
  let idx = 0, score = 0;
  const box = document.createElement("div"); box.className="grid";
  const qCard = document.createElement("div"); qCard.className="card";
  const p = document.createElement("div"); p.className="riddle-q";
  const opts = document.createElement("div");

  function render(){
    if(idx>=bank.length){
      box.innerHTML = `<div class="card big">å®Œæˆï¼å¾—åˆ†ï¼š${score}/${bank.length}</div>`;
      mount.appendChild(box); setStatus("é—–é—œå®Œæˆ"); return;
    }
    const item = bank[idx];
    qCard.innerHTML = `<div class="riddle-q">ç¬¬ ${idx+1}/${bank.length} é¡Œï¼š${item.q}</div>`;
    opts.innerHTML="";
    item.a.forEach((text, i)=>{
      const c = document.createElement("div");
      c.className="choice"; c.textContent = text;
      c.onclick = ()=>{
        const right = i===item.correct;
        c.classList.add(right?"correct":"wrong");
        if(right){ score++; setStatus("ç­”å°ï¼" + (item.explain? " " + item.explain:"")); }
        else setStatus("å†æƒ³æƒ³ï½ " + (item.explain? "æç¤ºï¼š"+item.explain:""));
        [...opts.children].forEach(n=>n.style.pointerEvents="none");
        setTimeout(()=>{ idx++; render(); }, 600);
      };
      opts.appendChild(c);
    });
    box.replaceChildren(qCard, opts);
    mount.appendChild(box);
  }
  render();
}

// 3) Story â€” åˆ†æ”¯æ•˜äº‹
function gameStory(){
  setGenre("åŠ‡æƒ…ï¼ˆåˆ†æ”¯æ•˜äº‹ï¼‰");
  clearMount();
  const nodes = CONFIG.storyNodes;
  let here = nodes.start;
  const card = document.createElement("div"); card.className="card story";
  function draw(){
    if(here.end){
      card.innerHTML = `<div>${here.text||""}</div><div class="big" style="margin-top:8px">${here.end}</div>`;
      setStatus("æ•…äº‹å®Œçµ");
      mount.replaceChildren(card); return;
    }
    const opts = (here.options||[]).map(o=>`<button class="opt" style="margin-right:6px">${o.t}</button>`).join("");
    card.innerHTML = `<div>${here.text||""}</div><div style="margin-top:10px">${opts}</div>`;
    mount.replaceChildren(card);
    [...card.querySelectorAll(".opt")].forEach((b,i)=>{
      b.onclick=()=>{ here = nodes[here.options[i].go]; draw(); };
    });
    setStatus("åšå‡ºä½ çš„é¸æ“‡");
  }
  draw();
}

// 4) Relax â€” å‘¼å¸ç¯€å¥
function gameRelax(){
  setGenre("èˆ’å£“ï¼ˆå‘¼å¸å¼•å°ï¼‰");
  clearMount();
  const wrap = document.createElement("div"); wrap.className="center grid";
  const bubble = document.createElement("div"); bubble.className="bubble center";
  const caption = document.createElement("div"); caption.className="hint"; caption.textContent="è·Ÿè‘—åœ“çƒæ”¾å¤§ç¸®å°å¸åæ°£";
  wrap.append(bubble, caption); mount.appendChild(wrap);

  const total = CONFIG.relax.durationSec||60;
  const step = (CONFIG.relax.cycleSec||8)/2; // ç°¡åŒ–ï¼šå¸4s/å4s
  let t = 0, grow=true;
  const timer = setInterval(()=>{
    t += 0.1;
    const scale = grow ? 1 + (t%step)/step*0.3 : 1.3 - (t%step)/step*0.3;
    bubble.style.transform = `scale(${scale})`;
    if(Math.floor(t)%step===0 && Math.abs((t%step)-0)<0.11){ grow=!grow; caption.textContent = grow? "å¸æ°£â€¦" : "åæ°£â€¦"; }
  }, 100);
  setTimeout(()=>{ clearInterval(timer); caption.textContent="å®Œæˆä¸€è¼ªæ”¾é¬†ï¼"; setStatus("çµæŸ"); }, total*1000);
}

/* ===== Router ===== */
function start(){
  applyTheme();
  setText("subtitle", CONFIG.subtitle||"");
  $("#btn-restart").onclick = start;
  const map = { puzzle:gamePuzzle, riddle:gameRiddle, story:gameStory, relax:gameRelax };
  (map[CONFIG.gameType]||gamePuzzle)();
}
start();
</script>
</body>
</html>
