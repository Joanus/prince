<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>å°ç‹å­ï¼šæ˜Ÿéš›å®ˆè­·ä¹‹æ—…ï½œäº’å‹•æ•˜äº‹ RPGï¼ˆè‡ªç„¶æ¸…æ–°é¢¨ï¼‰</title>
<style>
  :root{
    --bg:#f6fbf7;
    --card:#ffffffee;
    --ink:#2f3e2c;
    --muted:#6b7f6b;
    --accent:#6ac196;       /* è‡ªç„¶ç¶  */
    --accent-2:#89d6c9;     /* æ°´è‰² */
    --accent-3:#ffd27f;     /* æŸ”æš–é™½å…‰ */
    --danger:#e26d6d;       /* é¢¨éšªè­¦ç¤º */
    --leaf:#cfead8;
    --shadow: 0 12px 30px rgba(79,114,96,.18);
    --radius:16px;
  }
  html,body{height:100%}
  body{
    margin:0; font-family: "Noto Serif TC", "PingFang TC", "Hiragino Sans", "Microsoft JhengHei", serif;
    color:var(--ink); background: radial-gradient(1200px 900px at 20% -10%, #e5f7ef 0%, transparent 60%), radial-gradient(1000px 700px at 120% 10%, #e7fafc 0%, transparent 60%), var(--bg);
    overflow-x:hidden;
  }
  /* èƒŒæ™¯è£é£¾ï¼šè‘‰èˆ‡æ˜Ÿ */
  .decor{
    position:fixed; inset:0; pointer-events:none; z-index:-1;
    background:
      url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="300" height="300"><g fill="%23cfead8" opacity=".6"><circle cx="20" cy="40" r="2"/><circle cx="200" cy="30" r="1.5"/><circle cx="260" cy="120" r="2"/><circle cx="140" cy="200" r="1.8"/></g></svg>') repeat;
    mix-blend-mode:multiply;
    animation: twinkle 6s ease-in-out infinite;
  }
  @keyframes twinkle{
    0%,100%{opacity:.5} 50%{opacity:.9}
  }
  .wrap{
    max-width:980px; margin: clamp(12px,4vw,32px) auto;
    padding: clamp(12px,2vw,24px);
  }
  .card{
    background: var(--card); border-radius: var(--radius); box-shadow: var(--shadow);
    overflow: hidden; border: 1px solid #e7f2ea;
  }
  header{
    padding: 22px 24px; display:flex; gap:16px; align-items:center; background:linear-gradient(180deg, #f4fff7 0%, #fff 60%);
    border-bottom: 1px solid #e7f2ea;
  }
  .logo{
    width:52px; height:52px; border-radius:14px; background: conic-gradient(from 30deg, var(--accent), var(--accent-2), var(--accent-3));
    position:relative; box-shadow: 0 10px 20px rgba(106,193,150,.25) inset, 0 4px 10px rgba(0,0,0,.06);
  }
  .logo:after{
    content:""; position:absolute; inset:10px; border-radius:12px; background: radial-gradient(circle at 60% 40%, #fff8 0 40%, transparent 42%);
  }
  h1{font-size: clamp(20px, 2.6vw, 28px); margin:0}
  .sub{color:var(--muted); font-size: clamp(12px,1.6vw,14px)}
  main{display:grid; grid-template-columns: 1.1fr .9fr; gap:20px; padding: 18px 20px 24px}
  @media (max-width: 860px){
    main{grid-template-columns: 1fr}
  }
  .scene{
    background:#fff; border-radius: 14px; padding: 18px; border:1px solid #eef6f0; position:relative; overflow:hidden;
  }
  .scene:before{
    content:""; position:absolute; inset:-30px -30px auto auto; width:180px; height:180px; border-radius:50%;
    background: radial-gradient(closest-side, #fff9e6, transparent 70%); opacity:.6; filter: blur(1px);
  }
  .scene h2{margin: 6px 0 8px 0; font-size: 18px}
  .scene .text{line-height:1.7; font-size: 16px}
  .choices{display:grid; gap:10px; margin-top:14px}
  .choice{font-size: 16px; /* èª¿å¤§å­—é«” */; 
    border:1px solid #dff0e6; background: linear-gradient(180deg,#f8fffb,#fefefe);
    padding:12px 14px; border-radius:12px; cursor:pointer; transition:.2s transform, .2s box-shadow;
  }
  .choice:hover{transform: translateY(-1px); box-shadow: 0 10px 18px rgba(87,140,111,.12)}
  .choice small{display:block; color: var(--muted); margin-top:4px}
  .pill{
    display:inline-flex; align-items:center; gap:6px; padding:4px 10px; border-radius:999px; background:#ecfbf3; color:#2f6b4a; font-size:12px; border:1px solid #d8f1e2; margin-right:6px
  }
  .right{
    background:#fff; border:1px solid #eef6f0; border-radius:14px; padding:14px; position:relative;
  }
  .meter{display:grid; gap:10px}
  .bar{
    background:#f2faf5; border:1px solid #e3f2ea; border-radius:999px; height:14px; position:relative; overflow:hidden;
  }
  .bar>span{
    position:absolute; left:0; top:0; bottom:0; width:0%;
    background: linear-gradient(90deg, var(--accent), var(--accent-2));
    box-shadow: inset 0 -8px 12px rgba(255,255,255,.35);
    transition: width .45s ease;
  }
  .bar .cap{position:absolute; right:6px; top:50%; transform:translateY(-50%); color:#608a6e; font-size:12px}
  .label{display:flex; align-items:center; justify-content:space-between; color:#56735f; font-size:13px}
  .tags{display:flex; flex-wrap:wrap; gap:6px; margin:8px 0 4px}
  .note{color:#6c8371; background:#f4fbf7; border:1px dashed #cfead8; border-radius:10px; padding:10px 12px; font-size:13px}
  footer{padding:14px 20px; display:flex; gap:10px; align-items:center; justify-content:space-between; border-top:1px solid #e7f2ea}
  .btn{
    border:0; background: linear-gradient(180deg, #6ac196, #52b184);
    color:white; padding:10px 16px; border-radius:12px; cursor:pointer; box-shadow: 0 8px 18px rgba(106,193,150,.3);
    display:inline-flex; align-items:center; gap:8px; font-weight:700; letter-spacing:.03em
  }
  .btn:disabled{opacity:.5; cursor:not-allowed; box-shadow:none}
  .ghost{background:#ffffff; color:#2f6b4a; border:1px solid #cfead8; box-shadow:none}
  .fade-in{animation: fade .35s ease}
  @keyframes fade{from{opacity:.2; transform:translateY(6px)} to{opacity:1; transform:none}}
  .toast{
    position:fixed; right:16px; bottom:16px; background:#fff; border:1px solid #cfead8; box-shadow: var(--shadow); padding:10px 12px; border-radius:12px; color:#397455; font-size:14px;
    transform: translateY(20px); opacity:0; pointer-events:none;
  }
  .toast.show{opacity:1; transform: translateY(0)}
  /* çµå±€è¦–åœ– */
  .ending{
    display:none; padding: 22px; background: linear-gradient(180deg, #f7fff9, #fff);
  }
  .ending h2{font-size: 22px; margin:4px 0 8px}
  .ending .badge{
    display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border:1px solid #dff0e6; border-radius:999px; background:#f0fbf6; color:#2a6a4b; font-weight:700
  }
  .grid-2{display:grid; grid-template-columns:1fr 1fr; gap:16px}
  @media (max-width:720px){.grid-2{grid-template-columns:1fr}}
  .recap{background:#ffffff; border:1px solid #eef6f0; border-radius:14px; padding:12px}
  .chip{display:inline-block; background:#eef8f2; color:#396c51; border:1px solid #d8efe3; padding:4px 10px; border-radius:999px; font-size:12px; margin: 3px 5px 0 0}
  .warn{color:#a33; background:#fff4f4; border:1px solid #f3d1d1}
  /* å°å‹•ç•«ï¼šé¸æ“‡å›é¥‹ */
  .spark{
    position:absolute; inset:auto auto 10px 10px; font-size:12px; color:#2f6b4a; opacity:0; transform: translateY(6px);
  }
  .spark.show{opacity:1; transform:none; transition:.6s ease; }
</style>
</head>
<body>
<div class="decor" aria-hidden="true"></div>
<div class="wrap">
  <div class="card">
    <header>
      <div class="logo" aria-hidden="true"></div>
      <div>
        <h1>å°ç‹å­ï¼šæ˜Ÿéš›å®ˆè­·ä¹‹æ—…</h1>
        <div class="sub">è‡ªç„¶æ¸…æ–°ï½œå¥‡å¹»æ²»ç™’ï½œæ¨™æº–ç¯‡å¹… â€” åœ¨é¸æ“‡ä¹‹é–“ï¼Œçœ‹è¦‹ã€Œé¢¨éšªèˆ‡æº–å‚™ã€çš„å…‰ã€‚</div>
        <div class="tags" id="tags">
          <span class="pill">å¥½å¥‡ä¹‹æ˜Ÿ</span>
          <span class="pill">æ´å¯Ÿä¹‹å…‰</span>
          <span class="pill">å®ˆè­·ä¹‹ç¨®</span>
          <span class="pill">å¿ƒéˆæš–åº¦</span>
        </div>
      </div>
    </header>
    <main>
      <section class="scene fade-in">
        <h2 id="scene-title">åºç« ãƒ»B612 çš„æ¸…æ™¨</h2>
        <div id="scene-text" class="text">
          å°ç‹å­åœ¨è‡ªå·±çš„å°è¡Œæ˜Ÿä¸Šé†’ä¾†ï¼Œéœ²ç åœ¨ç«ç‘°çš„èŠ±ç“£ä¸Šé¡«æŠ–ã€‚é æ–¹é›²å±¤å †èµ·ï¼Œä¸€å ´å­£é¢¨æ­£æ‚„æ‚„é è¿‘ã€‚ä»–æƒ³å†æ¬¡å•Ÿç¨‹æ‹œè¨ªç¾¤æ˜Ÿï¼Œä½†ç«ç‘°ä»»æ€§åœ°èªªä¸å†·ä¹Ÿä¸æ€•é¢¨ã€‚å°ç‹å­çœ‹è‘—åªæœ‰ä¸‰åº§ç«å±±èˆ‡åŠæˆªé¢¨éˆ´ï¼Œå¿ƒè£¡çŸ¥é“æ—…é€”ç¸½æœ‰æ„å¤–ï¼šé¢¨ã€æ²™ã€è¿·é€”èˆ‡åˆ†åˆ¥ã€‚ä»–æ‘¸äº†æ‘¸å£è¢‹è£¡çš„ç¹©çµèˆ‡ç•«è‘—æ˜Ÿåœ–çš„å°æœ¬å­ï¼Œæ€ç´¢è©²å…ˆåšäº›ä»€éº¼ï¼Œå†é›¢é–‹ã€‚
        </div>
        <div class="choices" id="choices">
          <!-- choices injected by JS -->
        </div>
        <div class="spark" id="spark"></div>
      </section>
      <aside class="right">
        <div class="label"><strong>æ—…ç¨‹å±¬æ€§</strong><span id="stepLabel">ç¬¬ 1 / 5 å¹•</span></div>
        <div class="meter" id="meters">
          <div>
            <div class="label"><span>å¥½å¥‡ä¹‹æ˜Ÿ</span><span id="curiosityV">3</span></div>
            <div class="bar"><span id="curiosity"></span><div class="cap">10</div></div>
          </div>
          <div>
            <div class="label"><span>æ´å¯Ÿä¹‹å…‰</span><span id="insightV">3</span></div>
            <div class="bar"><span id="insight"></span><div class="cap">10</div></div>
          </div>
          <div>
            <div class="label"><span>å®ˆè­·ä¹‹ç¨®</span><span id="prepV">2</span></div>
            <div class="bar"><span id="prep"></span><div class="cap">10</div></div>
          </div>
          <div>
            <div class="label"><span>å¿ƒéˆæš–åº¦</span><span id="warmV">3</span></div>
            <div class="bar"><span id="warm"></span><div class="cap">10</div></div>
          </div>
        </div>
        <div class="note" style="margin-top:10px">
          å°æé†’ï¼š<strong>å®ˆè­·ä¹‹ç¨®</strong>è±¡å¾µæå‰æº–å‚™èˆ‡é¢¨éšªæ„è­˜ï¼›ç•¶æ—…é€”å‡ºç¾çªç™¼äº‹ä»¶ï¼Œå®ƒæœƒåƒä¸€æŠŠæº«æŸ”çš„å‚˜ï¼Œè®“å•é¡Œä¸è‡³æ–¼æˆç‚ºç½é›£ã€‚
        </div>
        <div class="tags" id="flags"></div>
      </aside>
    </main>
    <footer>
      <button class="btn ghost" id="restart" disabled>é‡æ–°é–‹å§‹</button>
      <div style="display:flex; gap:8px; align-items:center">
        <button class="btn" id="back" disabled>â¬… ä¸Šä¸€æ­¥</button>
        <button class="btn" id="skip">å¿«è½‰åˆ°çµå±€ â©</button>
      </div>
    </footer>

    <!-- çµå±€å€ -->
    <section class="ending" id="ending">
      <div class="badge" id="ending-badge">çµå±€</div>
      <h2 id="ending-title">â€”</h2>
      <p id="ending-text" class="text"></p>
      <div class="grid-2" style="margin-top:10px">
        <div class="recap">
          <h3 style="margin:6px 0 8px">æ—…ç¨‹å›é¡§</h3>
          <div id="recap-choices" class="text"></div>
        </div>
        <div class="recap">
          <h3 style="margin:6px 0 8px">æœ€çµ‚å±¬æ€§</h3>
          <div class="tags">
            <span class="chip">å¥½å¥‡ä¹‹æ˜Ÿï¼š<b id="rc-c"></b></span>
            <span class="chip">æ´å¯Ÿä¹‹å…‰ï¼š<b id="rc-i"></b></span>
            <span class="chip">å®ˆè­·ä¹‹ç¨®ï¼š<b id="rc-p"></b></span>
            <span class="chip">å¿ƒéˆæš–åº¦ï¼š<b id="rc-w"></b></span>
          </div>
          <div id="ending-gain" style="margin-top:8px"></div>
        </div>
      </div>
      <div class="note" style="margin:14px 0 8px">
        å•Ÿç¤ºï¼šé¢¨éšªä¸¦ä¸æ„›é©šåš‡äººï¼Œå®ƒåªæ˜¯æé†’æˆ‘å€‘æŠŠå‚˜å¸¶ä¸Šã€‚ç•¶å¿ƒæœ‰æ‰€æ„›ï¼Œæº–å‚™å°±æˆäº†æº«æŸ”çš„è²¬ä»»ã€‚
      </div>
      <footer style="border-top:0; padding-top:0; justify-content:flex-end">
        <button class="btn" onclick="engine.reset()">å†ç©ä¸€æ¬¡ ğŸŒ±</button>
      </footer>
    </section>
  </div>
</div>

<div class="toast" id="toast">å±¬æ€§è®ŠåŒ– +1</div>

<script>
/* =============================
   å°ç‹å­ï¼šæ˜Ÿéš›å®ˆè­·ä¹‹æ—…
   ç‰©ä»¶å°å‘ç‹€æ…‹æ©Ÿ + ç„¡ä¾è³´
   ä½œè€…ï¼šæ•…äº‹è½‰äº’å‹•ç¶²é åŠ©æ‰‹
   ============================= */

class StoryEngine{
  constructor(){
    // åˆå§‹å±¬æ€§ï¼ˆ0~10ï¼‰
    this.state = {
      step: 0,
      attrs: { curiosity:3, insight:3, prep:2, warm:3 },
      flags: {},           // ç‰¹æ®Šäº‹ä»¶è¨˜éŒ„
      log: []              // é¸æ“‡å›é¡§
    };
    this.maxStep = scenes.length-1;
    // ç¶å®š UI
    this.ui = {
      title: document.getElementById('scene-title'),
      text: document.getElementById('scene-text'),
      choices: document.getElementById('choices'),
      stepLabel: document.getElementById('stepLabel'),
      meters: {
        curiosity: document.getElementById('curiosity'),
        insight: document.getElementById('insight'),
        prep: document.getElementById('prep'),
        warm: document.getElementById('warm'),
        curiosityV: document.getElementById('curiosityV'),
        insightV: document.getElementById('insightV'),
        prepV: document.getElementById('prepV'),
        warmV: document.getElementById('warmV'),
      },
      flags: document.getElementById('flags'),
      back: document.getElementById('back'),
      restart: document.getElementById('restart'),
      skip: document.getElementById('skip'),
      spark: document.getElementById('spark'),
      toast: document.getElementById('toast'),
      ending: {
        section: document.getElementById('ending'),
        badge: document.getElementById('ending-badge'),
        title: document.getElementById('ending-title'),
        text: document.getElementById('ending-text'),
        recap: document.getElementById('recap-choices'),
        rc: {
          c: document.getElementById('rc-c'),
          i: document.getElementById('rc-i'),
          p: document.getElementById('rc-p'),
          w: document.getElementById('rc-w'),
        },
        gain: document.getElementById('ending-gain')
      }
    };
    // äº‹ä»¶
    this.ui.back.addEventListener('click', ()=>this.undo());
    this.ui.restart.addEventListener('click', ()=>this.reset());
    this.ui.skip.addEventListener('click', ()=>this.fastToEnd());
    this.render();
  }

  clamp(v){ return Math.max(0, Math.min(10, v)); }

  applyDelta(delta){
    // delta: {curiosity:+1, ...}, flags:{...}
    const before = JSON.parse(JSON.stringify(this.state.attrs));
    for(const k in delta){
      if(k in this.state.attrs){
        this.state.attrs[k] = this.clamp(this.state.attrs[k] + delta[k]);
      }
    }
    // é¡¯ç¤ºå°ç«èŠ±
    const diffs = Object.keys(this.state.attrs).map(k=>{
      const d = this.state.attrs[k] - before[k];
      return d!==0 ? `${attrName(k)} ${d>0?`+${d}`:d}` : null;
    }).filter(Boolean).join('ã€€');
    if(diffs){
      this.spark(`${diffs}`);
      this.toast(`å±¬æ€§æ›´æ–°ï¼š${diffs}`);
    }
  }

  setFlag(name, val=true){
    this.state.flags[name] = val;
    this.renderFlags();
  }

  spark(text){
    this.ui.spark.textContent = text;
    this.ui.spark.classList.remove('show');
    void this.ui.spark.offsetWidth;
    this.ui.spark.classList.add('show');
    setTimeout(()=>this.ui.spark.classList.remove('show'), 900);
  }
  toast(text){
    const t = this.ui.toast;
    t.textContent = text;
    t.classList.add('show');
    setTimeout(()=>t.classList.remove('show'), 1200);
  }

  pick(choice){
    const scene = scenes[this.state.step];
    // è¨˜éŒ„
    this.state.log.push({
      step: this.state.step,
      title: scene.title,
      pick: choice.title,
      note: choice.note || "",
      delta: choice.delta || {},
    });
    // æ‡‰ç”¨å±¬æ€§è®ŠåŒ–
    if(choice.delta) this.applyDelta(choice.delta);
    // è¨­æ——æ¨™
    if(choice.flag) this.setFlag(choice.flag, true);
    // ä¸‹ä¸€å¹•æˆ–çµå±€
    if(this.state.step < this.maxStep){
      this.state.step++;
      this.render();
    }else{
      this.finish();
    }
  }

  undo(){
    if(this.state.log.length===0) return;
    // å›é€€åˆ°ä¸Šä¸€å€‹æ±ºç­–å‰ç‹€æ…‹ï¼šç‚ºç¢ºä¿æ­£ç¢ºï¼Œé‡æ’­åˆ°å€’æ•¸ç¬¬äºŒæ­¥
    const keep = this.state.log.slice(0, -1);
    this.reset(false);
    for(const entry of keep){
      this.applyDelta(entry.delta || {});
      if(entry.flag) this.setFlag(entry.flag, true);
      this.state.log.push(entry);
      this.state.step++;
    }
    this.render();
  }

  reset(clearLog=true){
    this.state = {
      step: 0,
      attrs: { curiosity:3, insight:3, prep:2, warm:3 },
      flags: {},
      log: []
    };
    document.querySelector('.ending').style.display='none';
    document.querySelector('main').style.display='grid';
    document.querySelector('footer').style.display='flex';
    this.ui.restart.disabled = true;
    this.ui.back.disabled = true;
    this.ui.skip.disabled = false;
    this.renderFlags();
    this.render();
  }

  fastToEnd(){
    // è‹¥å°šæœªå®Œæˆï¼Œç›´æ¥è·³åˆ°çµå°¾ï¼ˆä»¥ç›®å‰å±¬æ€§è¨ˆç®—ï¼‰
    while(this.state.step < this.maxStep){
      // è‡ªå‹•é¸æ“‡ï¼šåå‘æå‡å®ˆè­·ä¹‹ç¨®çš„é¸é …
      const choices = scenes[this.state.step].choices;
      let c = choices.find(x=>x.delta && x.delta.prep>0) || choices[0];
      this.state.log.push({
        step: this.state.step, title: scenes[this.state.step].title,
        pick: `ï¼ˆç³»çµ±ä»£é¸ï¼‰${c.title}`, note: c.note||"", delta: c.delta||{}
      });
      if(c.delta) this.applyDelta(c.delta);
      if(c.flag) this.setFlag(c.flag, true);
      this.state.step++;
    }
    this.finish();
  }

  render(){
    const scene = scenes[this.state.step];
    // header
    this.ui.title.textContent = `${scene.title}`;
    this.ui.text.textContent = scene.text;
    // choices
    this.ui.choices.innerHTML = '';
    scene.choices.forEach((c, idx)=>{
      const div = document.createElement('button');
      div.className = 'choice';
      div.innerHTML = `<strong>${c.title}</strong>${c.note?`<small>${c.note}</small>`:''}`;
      div.addEventListener('click', ()=>{ this.pick(c); this.ui.back.disabled = this.state.log.length===0; this.ui.restart.disabled=false; });
      this.ui.choices.appendChild(div);
    });
    // meters
    this.ui.meters.curiosity.style.width = `${this.state.attrs.curiosity*10}%`;
    this.ui.meters.insight.style.width = `${this.state.attrs.insight*10}%`;
    this.ui.meters.prep.style.width = `${this.state.attrs.prep*10}%`;
    this.ui.meters.warm.style.width = `${this.state.attrs.warm*10}%`;
    this.ui.meters.curiosityV.textContent = this.state.attrs.curiosity;
    this.ui.meters.insightV.textContent = this.state.attrs.insight;
    this.ui.meters.prepV.textContent = this.state.attrs.prep;
    this.ui.meters.warmV.textContent = this.state.attrs.warm;
    // step label
    this.ui.stepLabel.textContent = `ç¬¬ ${this.state.step+1} / ${scenes.length} å¹•`;
  }

  renderFlags(){
    this.ui.flags.innerHTML = '';
    Object.keys(this.state.flags).forEach(k=>{
      const span = document.createElement('span');
      span.className = 'pill';
      span.textContent = flagLabel(k);
      this.ui.flags.appendChild(span);
    });
  }

  finish(){
    // éš±è—ä¸»å€ã€é¡¯ç¤ºçµå±€
    const A = this.state.attrs;
    const F = this.state.flags;
    const summary = decideEnding(A, F, this.state.log);
    this.ui.ending.badge.textContent = `çµå±€ / ${summary.code}`;
    this.ui.ending.title.textContent = `${summary.title}`;
    this.ui.ending.text.innerHTML = summary.text;
    this.ui.ending.rc.c.textContent = A.curiosity;
    this.ui.ending.rc.i.textContent = A.insight;
    this.ui.ending.rc.p.textContent = A.prep;
    this.ui.ending.rc.w.textContent = A.warm;
    this.ui.ending.gain.innerHTML = summary.reward.map(s=>`<span class="chip">${s}</span>`).join('');
    // recap
    this.ui.ending.recap.innerHTML = this.state.log.map((e,i)=>{
      const ds = Object.entries(e.delta||{}).map(([k,v])=>`${attrName(k)} ${v>0?`+${v}`:v}`).join('ï¼Œ');
      return `<div style="margin-bottom:8px"><b>ç¬¬ ${i+1} å¹•ï½œ${e.title}</b><br>ä½ çš„é¸æ“‡ï¼š${e.pick}${e.note?`<br><span class="muted" style="color:#6b7f6b">${e.note}</span>`:""}<br><span style="font-size:12px;color:#6b7f6b">å±¬æ€§ï¼š${ds||'â€”'}</span></div>`;
    }).join('');
    document.querySelector('main').style.display='none';
    document.querySelector('footer').style.display='none';
    this.ui.ending.section.style.display='block';
  }
}

// ===== å·¥å…·ï¼šå‘½åèˆ‡æ¨™ç±¤ =====
function attrName(k){
  return {
    curiosity:'å¥½å¥‡ä¹‹æ˜Ÿ',
    insight:'æ´å¯Ÿä¹‹å…‰',
    prep:'å®ˆè­·ä¹‹ç¨®',
    warm:'å¿ƒéˆæš–åº¦'
  }[k] || k;
}
function flagLabel(k){
  return {
    coveredRose:'ç«ç‘°ç½©éˆ´ä¿è­·',
    patchedRoof:'ä¿®è£œå±‹é ‚',
    compass:'å¾—åˆ°äº†æŒ‡åŒ—é‡',
    tamedFox:'é¦´é¤Šäº†ç‹ç‹¸',
    safetyKit:'ç·¨ç¹”æ‡‰è®ŠåŒ…',
    sandAnchor:'é¢¨ç¹©å›ºå®šé£›è¡Œå™¨'
  }[k] || k;
}

// ===== åŠ‡æƒ…ï¼ˆæ¨™æº–ç‰ˆï¼šæ¯æ®µç´„ 250â€“350 å­—ï¼‰ =====
const scenes = [
  {
    title: "ç¬¬ä¸€å¹•ãƒ»B612 çš„æŠ‰æ“‡",
    text:
      "é›²å½±å£“ä½ï¼Œå°ç‹å­çŸ¥é“é›¢åˆ¥ç¸½æœ‰é¢¨è²ã€‚ä»–çœ‹è‘—ç»ç’ƒç½©èˆ‡ç«ç‘°ï¼Œé‚£æœµè‡ªçŸœåˆè„†å¼±çš„èŠ±èªªè‡ªå·±ä¸æ€•ã€‚ç«å±±å£é‚„æœªæ¸…ï¼Œå±‹é ‚ä¹Ÿåœ¨ä¸Šæ¬¡æµæ˜Ÿé›¨å¾Œç•™ä¸‹ä¸€é“ç´°ç¸«ã€‚ä»–æƒ³å•Ÿç¨‹å»æ‹œè¨ªæ–°çš„æ˜Ÿçƒï¼Œå¿ƒä¸­å»æœ‰ä¸€ç²’ç´°å°çš„æ“”æ†‚ï¼šå¦‚æœé¢¨åœ¨ä»–é›¢é–‹æ™‚è®Šå¤§ï¼Œç«ç‘°æœƒä¸æœƒè‘—æ¶¼ï¼Ÿä»–ç¿»å‡ºä¸€å¡Šè¼•è–„çš„ç½©éˆ´èˆ‡å¹¾æ ¹ç¹©å­ï¼Œé‚„æœ‰å¯«æ»¿å¡—é´‰çš„æ˜Ÿåœ–å°å†Šã€‚æ—…é€”éœ€è¦å‹‡æ°£ï¼Œä¹Ÿéœ€è¦ç…§æ–™æœªä¾†å¯èƒ½ç™¼ç”Ÿçš„äº‹ã€‚",
    choices:[
      { title:"å…ˆç‚ºç«ç‘°å¥—ä¸Šç½©éˆ´ï¼Œå†æ•´ç†ä¸‰åº§ç«å±±", note:"å‡ºç™¼å‰çš„ç´°å¿ƒï¼Œè®“æ€å¿µä¸è¢«æ“”å¿ƒåµé†’ã€‚", delta:{prep:+2, insight:+1, warm:+1}, flag:'coveredRose' },
      { title:"ç«‹åˆ»å•Ÿç¨‹ï¼Œè®“é¢¨å¸¶è·¯", note:"æŠŠä¸å®‰äº¤çµ¦æ˜Ÿå…‰ï¼Œå¸¶è‘—å–®ç´”å‰è¡Œã€‚", delta:{curiosity:+2, warm:+0} },
      { title:"å‘é„°è¿‘çš„å°è¡›æ˜Ÿæ±‚åŠ©ï¼Œç¢ºèªå¤©æ°£èˆ‡é¢¨å‘", note:"é¡˜æ„å•è·¯çš„äººæœƒå°‘èµ°å½è·¯ã€‚", delta:{insight:+2, warm:+1} }
    ]
  },
  {
    title: "ç¬¬äºŒå¹•ãƒ»åœ‹ç‹çš„å±‹é ‚",
    text:
      "ç¬¬ä¸€ç«™æ˜¯è‡ªç¨±çµ±å¾¡è¬ç‰©çš„åœ‹ç‹æ˜Ÿã€‚åœ‹ç‹æŠ«è‘—æ‹–åœ°çš„æ–—ç¯·ï¼Œå°å°ç‹å­èªªï¼šã€æˆ‘å‘½ä»¤é¢¨å¿…é ˆæº«æŸ”ã€‚ã€ç„¶è€Œè§’è½çš„å±‹é ‚è£‚ç¸«åœ¨å˜¶å˜¶ä½œéŸ¿ï¼Œä¾å¾å¿™è‘—èˆ‰æ¬Šæ–ï¼Œå»æ²’äººå»è£œç“¦ã€‚å°ç‹å­æƒ³èµ·è‡ªå·±è¡Œæ˜Ÿçš„é‚£é“ç¸«ï¼Œç†è§£åˆ°è²éŸ³å†å¤§ä¹Ÿæ“‹ä¸ä½é›¨æ°´ã€‚åœ‹ç‹é‚€ä»–æˆç‚ºã€å¤§è‡£ã€ï¼Œè² è²¬è®šå˜†æ¯ä¸€å€‹å‘½ä»¤ï¼›æ˜Ÿç©ºå¾ˆç¾ï¼Œä½†æ›´ç¾çš„æ˜¯èƒ½è®“æ˜å¤©ä¸æ¼æ°´çš„æ‰‹ã€‚",
    choices:[
      { title:"å‘åœ‹ç‹å©‰è½‰å»ºè­°ï¼šå…ˆä¿®å±‹é ‚å†è¬›å‘½ä»¤", note:"çœ‹è¦‹è¡¨é¢ä¹‹å¤–ï¼Œæ‰æ˜¯å…‰ã€‚", delta:{insight:+2, prep:+1}, flag:'patchedRoof' },
      { title:"æ¥å—é ­éŠœï¼Œå­¸ç¿’å¨å„€èˆ‡ç¦®ç¯€", note:"ç¦®ç¯€è®“äººé è¿‘ï¼Œä½†ä¸ä¸€å®šæ“‹é›¨ã€‚", delta:{warm:+1, curiosity:+1} },
      { title:"è‡ªå·±å‹•æ‰‹è£œç“¦ï¼Œä»¥è¡Œå‹•ä½œç‚ºå‹¸å‘Š", note:"æœ‰æ™‚æ²‰é»˜çš„æ‰‹æ¯”è©±èªéŸ¿äº®ã€‚", delta:{prep:+2, warm:+1}, flag:'patchedRoof' }
    ]
  },
  {
    title: "ç¬¬ä¸‰å¹•ãƒ»æ•¸æ˜Ÿçš„å•†äºº",
    text:
      "ä¸‹ä¸€é¡†æ˜Ÿçƒä½è‘—ä¸€ä½å¿™ç¢Œçš„å•†äººã€‚ä»–ç”¨å¸³å†Šåœˆä½æ¯ä¸€é¡†æ˜Ÿï¼Œèªªé‚£éƒ½æ˜¯è‡ªå·±çš„è²¡ç”¢ã€‚å°ç‹å­å•ï¼šã€ä½ æ“æœ‰å®ƒå€‘ï¼Œå°±æœƒæ›´æ‡‚å¾—å®ƒå€‘å—ï¼Ÿã€å•†äººæ–é ­ï¼Œåªèªªæ“æœ‰è®“ä»–å®‰å¿ƒã€‚æ¡Œä¸Šæœ‰ä¸€æšèˆŠæŒ‡åŒ—é‡èˆ‡ä¸€å£ºæ°´ï¼Œè§’è½å †è‘—è½æ»¿ç°çš„å†’éšªæ‰‹å†Šã€‚å°ç‹å­æƒ³ï¼ŒçœŸæ­£èƒ½å¸¶è·¯çš„ï¼Œæˆ–è¨±ä¸æ˜¯æ¨™åƒ¹ï¼Œè€Œæ˜¯é¡˜æ„é¢å°æœªçŸ¥æ™‚çš„ä¸€é»æº–å‚™èˆ‡ä¸€ä»½åˆ†äº«ã€‚",
    choices:[
      { title:"äº¤æ›ï¼šæŠŠè‡ªå·±çš„æ˜Ÿåœ–æŠ„çµ¦å•†äººï¼Œæ›å–æŒ‡åŒ—é‡", note:"å·¥å…·ä¸æ˜¯è†½é‡ï¼Œä½†èƒ½è®“è†½é‡èµ°å¾—æ›´é ã€‚", delta:{prep:+2, insight:+1}, flag:'compass' },
      { title:"é™ªå•†äººä¸€èµ·æ•¸æ˜Ÿï¼Œç·´ç¿’è€å¿ƒ", note:"éœä¸‹ä¾†ï¼Œä¹Ÿæ˜¯ä¸€ç¨®æ—…è¡Œã€‚", delta:{warm:+1, curiosity:+1, insight:+1} },
      { title:"æŠŠæ°´åˆ†çµ¦å£æ¸´çš„æ—…äººï¼Œè«‹ä»–åˆ†äº«ç©¿è¶Šæ²™å€çš„æŠ€å·§", note:"åˆ†äº«è®“è·¯æ›´æ¸…æ¥šã€‚", delta:{warm:+2, insight:+1, prep:+1} }
    ]
  },
  {
    title: "ç¬¬å››å¹•ãƒ»ç‹ç‹¸çš„é‚€è«‹",
    text:
      "ä¸€ç‰‡éº¥ç”°é‚Šï¼Œç‹ç‹¸å‘ä»–é»é ­ï¼šã€è«‹é¦´é¤Šæˆ‘å§ã€‚ã€é¦´é¤Šéœ€è¦æ™‚é–“ï¼Œä¹Ÿéœ€è¦æ‰¿è«¾ã€‚ç‹ç‹¸èªªï¼Œé¢¨èµ·æ™‚ï¼Œéº¥æµªåƒé‡‘è‰²çš„æµ·ï¼›å±éšªä¾†æ™‚ï¼Œæ´ç©´è¦å…ˆæ¸…å¥½ã€è·¯æ¨™è¦æ’ç©©ã€‚å°ç‹å­æƒ³èµ·ç«ç‘°èˆ‡é è¡Œï¼Œä¹Ÿæƒ³èµ·é‚£äº›ä¸æœŸè€Œè‡³çš„æš´é¢¨ã€‚ä»–å¯ä»¥é¸æ“‡å­¸ç¿’ç‹ç‹¸çš„è¦çŸ©ï¼Œæˆ–è¿½é€å¤©é‚Šçš„æµæ˜Ÿï¼Œè®“å¿ƒåªæœ‰å¥”è·‘çš„æ–¹å‘è€Œæ²’æœ‰æ­‡æ¯çš„æ£²æœ¨ã€‚",
    choices:[
      { title:"æ¥å—é¦´é¤Šå„€å¼ï¼Œå­¸ç¿’ã€ç›¸è¦‹çš„æ™‚é–“ã€èˆ‡ã€é›¢åˆ¥çš„æº–å‚™ã€", note:"é—œä¿‚è®“ä¸–ç•Œæœ‰äº†é‡é‡ã€‚", delta:{warm:+2, insight:+1, prep:+1}, flag:'tamedFox' },
      { title:"è¿½é€æµæ˜Ÿï¼Œæ”¶é›†æ•…äº‹", note:"æ•…äº‹æœƒç™¼å…‰ï¼Œä½†ä¹Ÿæœƒå¿˜è¨˜å›å®¶çš„è·¯ã€‚", delta:{curiosity:+2} },
      { title:"è·Ÿç‹ç‹¸ä¸€èµ·ç·¨ç¹”ç°¡æ˜“æ‡‰è®ŠåŒ…èˆ‡è¨Šè™Ÿæ——", note:"ç•¶å¿ƒæœ‰æ‰€æ„›ï¼Œå°±æœƒæƒ³æŠŠé¢¨æ”¶é€²è¢‹å­ã€‚", delta:{prep:+3, insight:+1}, flag:'safetyKit' }
    ]
  },
  {
    title: "ç¬¬äº”å¹•ãƒ»æ²™æµ·èˆ‡é¢¨ç¹©",
    text:
      "ç©¿è¶Šæ²™æ¼ ï¼Œä»–é‡è¦‹è¿·é€”çš„é£›è¡Œå“¡ã€‚é»ƒæ²™å¿½ç„¶å‡èµ·ï¼Œåƒå·¨å¤§çš„ç¸åœ¨åœ°å¹³ç·šå¥”è·‘ã€‚å°ç‹å­æƒ³èµ·å£è¢‹è£¡çš„æŒ‡åŒ—é‡ã€ç‹ç‹¸æ•™çš„æ——èªï¼Œé‚„æœ‰åœ¨è‡ªå®¶è¡Œæ˜Ÿå­¸æœƒçš„é‚£ä»½ä¸æ…Œã€‚ä»–çŸ¥é“ç¾åœ¨æ¯ä¸€å€‹æ±ºå®šï¼Œéƒ½æœƒè®“æ•…äº‹å¾€ä¸åŒæ–¹å‘å»¶ä¼¸ï¼šæˆ–æ˜¯æ€¥è‘—å•Ÿèˆªï¼Œè¢«é¢¨æ¨ç¿»ï¼›æˆ–æ˜¯å…ˆæŠŠé¢¨ç¹©å›ºå®šï¼Œå†è«‡è·¯ç·šï¼›æˆ–æ˜¯å‘æ˜Ÿå…‰æ±‚åŠ©ï¼Œè®“å¤œç©ºæˆç‚ºå¯é çš„åœ°åœ–ã€‚",
    choices:[
      { title:"å…ˆç”¨ç¹©ç´¢æŠŠé£›è¡Œå™¨èˆ‡çŸ³éŒ˜å›ºå®šï¼Œå†å°‹æ‰¾èƒŒé¢¨è™•", note:"å…ˆå®‰ï¼Œå†è«‡é æ–¹ã€‚", delta:{prep:+3, insight:+1}, flag:'sandAnchor' },
      { title:"è¶é¢¨å‹¢æœªæ»¿ç«‹åˆ»èµ·é£›", note:"æœ‰æ™‚å¿«ä¸€æ­¥ï¼Œä¹Ÿå¯èƒ½å°‘çœ‹ä¸€æ­¥ã€‚", delta:{curiosity:+2, prep:-1} },
      { title:"å¤œå¾…ç¾¤æ˜Ÿï¼Œåˆ©ç”¨æŒ‡åŒ—é‡èˆ‡æ——èªæ ¡å°èˆªç·š", note:"æ…¢ä¸‹ä¾†ï¼Œè®“å…‰å°æº–ã€‚", delta:{insight:+2, prep:+1} }
    ]
  }
];

// ===== çµå±€åˆ¤å®š =====
function decideEnding(A, F, log){
  const total = A.curiosity + A.insight + A.prep + A.warm;

  // éš±è—çµå±€ï¼šå®ˆè­·ä¹‹ç¨®é«˜ï¼Œä¸”è‡³å°‘å…©å€‹é—œéµæº–å‚™æ——æ¨™
  const keyPrep = ['coveredRose','patchedRoof','compass','safetyKit','sandAnchor'];
  const prepFlags = keyPrep.filter(k=>F[k]).length;

  // 1) éš±è— â€” æ™‚å…‰çš„åº‡è­·
  if(A.prep>=8 && prepFlags>=2 && F.tamedFox){
    return {
      code:"E5",
      title:"â³ æ™‚å…‰çš„åº‡è­·",
      text:
        "é¢¨æš´çµ‚ç©¶ä¾†éï¼Œå»åƒè¢«æº«æŸ”åœ°è«‹åˆ°å±‹å¤–ã€‚é£›è¡Œå™¨ç©©ç©©è½åœ¨èƒŒé¢¨çš„è°·åœ°ï¼Œç‹ç‹¸æ•™çš„æ——èªåœ¨æ²™ä¸˜ä¸Šé–ƒè€€ã€‚é æ–¹çš„ç«ç‘°åœ¨ç½©éˆ´ä¸‹å®‰ç¡ï¼Œå°ç‹å­æŠŠå¯«è‘—è·¯æ¨™çš„é è§’æ‘ºå¥½ï¼Œèˆ‡é£›è¡Œå“¡ä¸¦è‚©çœ‹å¤©äº®ã€‚åŸä¾†ã€é å…ˆçš„ç…§æ–™ã€æœƒæ‚„æ‚„ç‚ºæ˜å¤©å¢Šä¸€å±¤è»Ÿå¢Šï¼Œè®“æ„å¤–æˆç‚ºæ•…äº‹ï¼Œè€Œä¸æ˜¯å‚·ç—•ã€‚ä»–å¾—åˆ°çš„ä¸æ˜¯å‹åˆ©ï¼Œè€Œæ˜¯ä¸€ç¨®èƒ½åˆ†äº«çµ¦ä»–äººçš„å®‰å®šã€‚",
      reward:["ç¨±è™Ÿï¼šéœå¥½çš„å®ˆæœ›è€…","æŠ€èƒ½ï¼šæå‰é‹ªè·¯","åŠ æˆï¼šçªç™¼ç‹€æ³æ¸›å‚·"],
    };
  }

  // 2) ç†æƒ³ â€” ç¹æ˜Ÿå®ˆæœ›è€…ï¼šå››é …ç›¸å°å¹³è¡¡ä¸” prep>=6
  const balanced = [A.curiosity,A.insight,A.prep,A.warm];
  const spread = Math.max(...balanced) - Math.min(...balanced);
  if(spread<=3 && A.prep>=6 && A.insight>=5){
    return {
      code:"E1",
      title:"âœ¨ ç¹æ˜Ÿå®ˆæœ›è€…",
      text:
        "æ—…ç¨‹åœ¨é»æ˜æ”¶æŸã€‚ä½ ä¿®äº†å±‹é ‚ã€ä¹Ÿå­¸æœƒå‘äººè«‹æ•™ï¼›ä½ ä»ç†±æ„›æœªçŸ¥ï¼Œå»æ‡‚å¾—å…ˆæŠŠé¢¨ç¹©ç¶å¥½ã€‚ç‹ç‹¸åœ¨éº¥æµªä¸­æ‰“æ»¾ï¼Œç«ç‘°åœ¨ç½©éˆ´ä¸‹æ‰“ç›¹ã€‚å°ç‹å­çŸ¥é“ï¼šæº–å‚™ä¸æ˜¯æ‡·ç–‘æ˜å¤©ï¼Œè€Œæ˜¯è®“æ˜å¤©æœ‰æ©Ÿæœƒæ›´æº«æŸ”ã€‚æ–¼æ˜¯ä»–æŠŠæŒ‡åŒ—é‡é€çµ¦é£›è¡Œå“¡ï¼Œè®“å½¼æ­¤çš„è·¯éƒ½æ›´æ¸…æ¥šã€‚",
      reward:["ç¨±è™Ÿï¼šç¹æ˜Ÿå®ˆæœ›è€…","æŠ€èƒ½ï¼šå¹³è¡¡æŠ‰æ“‡","ç‰¹æ€§ï¼šé¢¨éšªè½‰åŒ–ç‚ºç¶“é©—"]
    };
  }

  // 3) å°ˆæ¥­æˆåŠŸä½†äººéš›ç–é›¢ â€” å­¤è¡Œçš„æ—…è€…ï¼šé«˜æ´å¯Ÿé«˜æº–å‚™ä½†ä½æš–åº¦
  if(A.insight>=7 && A.prep>=6 && A.warm<=4){
    return {
      code:"E2",
      title:"ğŸŒŒ å­¤è¡Œçš„æ—…è€…",
      text:
        "ä½ é æ¸¬é¢¨å‘ï¼Œä¹Ÿè®€æ‡‚æ²™æµ·çš„ç´‹ç†ã€‚é£›è¡Œå™¨å®‰å…¨ç©¿è¶Šï¼Œå¯æ˜¯é“åˆ¥ç¸½æ˜¯ç°¡çŸ­ã€‚ç‹ç‹¸åœ¨é æ–¹æœ›è‘—ä½ ï¼Œç«ç‘°ä¹Ÿå­¸æœƒä¸å†æŠ±æ€¨ã€‚ä½ ç¢ºå¯¦æŠŠå±éšªåŒ–ç‚ºå°äº‹ï¼Œå»ä¹Ÿè®“å¿ƒè®Šå¾—è¼•ä¸å‹é‡ã€‚å°ç‹å­æ˜ç™½äº†ï¼šæº–å‚™å›ºç„¶é‡è¦ï¼Œè‹¥å°‘äº†å½¼æ­¤ï¼ŒæŠµé”å°±åƒç©ºè•©çš„æ˜Ÿæ¸¯ã€‚",
      reward:["ç¨±è™Ÿï¼šå½±ä¸­è¡Œè€…","æŠ€èƒ½ï¼šé¢¨å‘åˆ¤è®€","æé†’ï¼šé—œä¿‚éœ€è¦æ™‚é–“"]
    };
  }

  // 4) å’Œè«§çµå±€ â€” èŠ±åœ’çš„å®ˆè­·äººï¼šé«˜æš–åº¦ã€é—œä¿‚æ——æ¨™ï¼Œå“ªæ€•ç›®æ¨™æœªç›¡
  if(A.warm>=7 && (F.tamedFox || F.coveredRose)){
    return {
      code:"E3",
      title:"ğŸŒ¿ èŠ±åœ’çš„å®ˆè­·äºº",
      text:
        "ä½ ç‚ºç«ç‘°æŠ«ä¸Šç½©éˆ´ï¼Œä¹ŸæŒ‰ç‹ç‹¸çš„ç¯€å¥ç›¸æœƒã€‚é¢¨æš´ä¾†æ™‚ï¼Œä½ é¡˜æ„åœä¸‹è…³æ­¥èˆ‡äººåŒé¿ã€‚æˆ–è¨±æ—…ç¨‹å› æ­¤æ…¢äº†ä¸€äº›ï¼›å¯éº¥ç”°æ›´é‡‘ã€å¤œè‰²æ›´è¿‘ã€‚å°ç‹å­æ‡‚å¾—ï¼Œå®ˆè­·ä¸¦ä¸æ˜¯ä¸å»é æ–¹ï¼Œè€Œæ˜¯è®“é‡è¦çš„äº‹ç‰©åœ¨é æ–¹ä¹Ÿèƒ½è¢«å¥½å¥½ç…§æ–™ã€‚",
      reward:["ç¨±è™Ÿï¼šèŠ±åœ’çš„å®ˆè­·äºº","æŠ€èƒ½ï¼šé™ªä¼´èˆ‡ç…§æ‡‰","å¤©è³¦ï¼šå…±äº«èˆ‡äº’åŠ©"]
    };
  }

  // 5) å£çµå±€ â€” æµæ˜Ÿçš„éºæ†¾ï¼šæº–å‚™éä½æˆ–å€‰ä¿ƒå†’é€²
  if(A.prep<=3 || (A.curiosity>=7 && A.prep<=4 && !F.sandAnchor)){
    return {
      code:"E4",
      title:"ğŸ’« æµæ˜Ÿçš„éºæ†¾",
      text:
        "ä½ é¸æ“‡è¿½è‘—é¢¨è·‘ï¼Œæ•…äº‹ç‡¦çˆ›å»çŸ­å¾—åƒä¸€é¡†åŠƒéçš„æµæ˜Ÿã€‚æ²™ç‰†åœ¨åŠç©ºç¿»å·ï¼Œé£›è¡Œå™¨è¢«è¿«é™ï¼›é æ–¹çš„ç½©éˆ´ä¹Ÿåœ¨é¢¨ä¸­å®å™¹ã€‚é‚£ä¸€åˆ»ï¼Œå°ç‹å­ç¬¬ä¸€æ¬¡æ‡‚å¾—ï¼šå‹‡æ•¢ä¸¦ä¸åå°æº–å‚™ï¼Œæ²’æœ‰ç¹©çµçš„ç†±æƒ…ï¼ŒæœƒæŠŠæƒ³å®ˆè­·çš„æ±è¥¿ä¸€ä½µå¹æ•£ã€‚",
      reward:["ç¨±è™Ÿï¼šé¢¨ä¸­æ‹¾å…‰è€…","æ•™è¨“ï¼šé€Ÿåº¦ä¸ç­‰æ–¼æ–¹å‘","æç¤ºï¼šè®“ã€å®ˆè­·ä¹‹ç¨®ã€å…ˆç™¼èŠ½"]
    };
  }

  // å…œåº•ï¼šä¾ç¸½åˆ†èˆ‡å‚¾å‘
  if(total>=24) {
    return {
      code:"E1*",
      title:"âœ¨ ç¹æ˜Ÿå®ˆæœ›è€…",
      text:
        "ä½ æŠŠé æ–¹èˆ‡è¿‘è™•ç¶åœ¨ä¸€èµ·ï¼šæ—¢ä¸æç†±æƒ…ï¼Œä¹Ÿä¸å¿˜æº–å‚™ã€‚é¢¨åœ¨èƒŒå¾Œæ¨è‘—ä½ ï¼Œè€ŒéæŠŠä½ æ¨å€’ã€‚å°ç‹å­å­¸æœƒæŠŠæ¯ä¸€æ¬¡å‡ºç™¼ï¼Œè®Šæˆå°æ˜å¤©çš„ç…§æ–™ã€‚",
      reward:["ç¨±è™Ÿï¼šç¹æ˜Ÿå®ˆæœ›è€…","æŠ€èƒ½ï¼šå¹³è¡¡æŠ‰æ“‡"]
    };
  }else{
    return {
      code:"E4*",
      title:"ğŸ’« æµæ˜Ÿçš„éºæ†¾",
      text:
        "æ—…é€”é›–ç¾ï¼Œå»è¢«å¹¾é™£æ„å¤–æ‰“å¾—é›¶æ•£ã€‚ä½ çœ‹è¦‹äº†é¢¨æš´çš„è„¾æ°£ï¼Œä¹Ÿçœ‹è¦‹äº†æº–å‚™çš„é‡é‡ã€‚ä¸‹æ¬¡ï¼Œè¨˜å¾—å…ˆæŠŠé¢¨ç¹©ç¶ç·Šï¼Œå†è¿½æµæ˜Ÿã€‚",
      reward:["ç¨±è™Ÿï¼šé¢¨çš„å­¸å¾’","æç¤ºï¼šææ—©é‹ªå¢Šï¼Œæ›ä¾†å¾å®¹"]
    };
  }
}

// ====== å•Ÿå‹• ======
const engine = new StoryEngine();

// ========== å…§å®¹å®‰å…¨ï¼šé˜²æ­¢æœªå®šç¾©éŒ¯èª¤ ==========
window.addEventListener('error', (e)=>{
  console.warn('æ•æ‰åˆ°éŒ¯èª¤ï¼š', e.message);
});

</script>
</body>
</html>
