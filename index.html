<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>遊戲模板啟動器</title>
<style>
  :root{
    --bg:#0b1020; --panel:#131a2e; --ink:#e9ecf5; --muted:#9fb0d6;
    --accent:#6ad1ff; --ok:#66e3a0; --warn:#ffd36a; --danger:#ff6b6b;
  }
  html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg),#0e1630);}
  body{font-family: system-ui, -apple-system, "Noto Sans TC", Segoe UI, Roboto, Arial, "PingFang TC", "Microsoft JhengHei", sans-serif; color:var(--ink); display:flex; align-items:center; justify-content:center; padding:20px;}
  .shell{width:min(920px,100%); background:rgba(19,26,46,.8); border:1px solid #1f2a4a; border-radius:16px; box-shadow:0 10px 40px rgba(0,0,0,.35); overflow:hidden;}
  header{padding:18px 20px; border-bottom:1px solid #1f2a4a; display:flex; gap:10px; align-items:center; justify-content:space-between;}
  header h1{font-size:18px; margin:0; letter-spacing:.5px}
  header .meta{font-size:13px; color:var(--muted)}
  main{padding:18px;}
  .toolbar{display:flex; gap:8px; flex-wrap:wrap; margin-bottom:16px}
  button{background:#1a2444; color:var(--ink); border:1px solid #2a3968; padding:10px 14px; border-radius:12px; cursor:pointer}
  button:hover{background:#1f2b52}
  .pill{font-size:12px; padding:6px 10px; border-radius:999px; background:#19213e; border:1px solid #2a3968; color:var(--muted)}
  .grid{display:grid; gap:12px}
  .center{display:flex; align-items:center; justify-content:center}
  .card{background:#101733; border:1px solid #1f2a4a; border-radius:12px; padding:14px}
  .big{font-size:24px; text-align:center}
  /* Puzzle (memory) */
  .board{display:grid; gap:10px; justify-content:center}
  .tile{width:72px; height:72px; background:#121b3a; border:1px solid #2a3968; border-radius:10px; display:flex; align-items:center; justify-content:center; font-size:28px; cursor:pointer; transform:translateZ(0); transition:transform .12s}
  .tile.revealed{background:#1a2448}
  .tile.matched{background:#173a2a; border-color:#2d5b47}
  /* Riddle */
  .riddle-q{font-weight:700; margin-bottom:8px}
  .choice{padding:10px 12px; border-radius:10px; border:1px solid #2a3968; cursor:pointer; margin:6px 0; background:#141c3a}
  .choice.correct{outline:2px solid var(--ok)}
  .choice.wrong{outline:2px solid var(--danger)}
  /* Story */
  .story{line-height:1.7}
  .story .opt{margin-top:10px}
  /* Relax */
  .bubble{width:220px; height:220px; border-radius:50%; background:radial-gradient(circle at 30% 30%, #7fe4ff, #215a86); box-shadow:0 0 40px rgba(106,209,255,.4) inset, 0 0 24px rgba(106,209,255,.3)}
  .hint{color:var(--muted); font-size:14px; text-align:center; margin-top:10px}
  .footer{padding:14px 20px; border-top:1px solid #1f2a4a; display:flex; align-items:center; justify-content:space-between; color:var(--muted); font-size:12px}
  .hidden{display:none!important}
</style>
</head>
<body>
<div class="shell">
  <header>
    <h1 id="title">遊戲模板</h1>
    <div class="meta" id="subtitle"></div>
  </header>
  <main>
    <div class="toolbar">
      <span class="pill" id="genre-pill"></span>
      <button id="btn-restart">重新開始</button>
    </div>
    <div id="mount"></div>
  </main>
  <div class="footer">
    <div>© Template Kit</div>
    <div id="footer-status">準備就緒</div>
  </div>
</div>

<!-- ======== 只要改這段 CONFIG，就能快速出 4 種遊戲 ======== -->
<script>
const CONFIG = {
  gameType: "puzzle", // "puzzle" | "riddle" | "story" | "relax"
  title: "腦力小劇場",
  subtitle: "改上面的 gameType 即可切換不同模板",
  palette: { bg:"#0b1020", accent:"#6ad1ff" },
  locale: "zh-TW",
  difficulty: "normal", // "easy" | "normal" | "hard"
  // 題庫/文本 —— 可以讓 ChatGPT 模組動態產生
  riddleBank: [
    { q:"什麼東西越洗越髒？", a:["水","毛巾","肥皂"], correct:1, explain:"毛巾用來擦拭，越擦越髒。" },
    { q:"什麼門永遠關不上？", a:["車門","球門","窗門"], correct:1, explain:"球門比賽用，沒有門扇。" },
    { q:"什麼人早上四隻腳，中午兩隻腳，晚上三隻腳？", a:["人","狗","外星人"], correct:0, explain:"嬰兒爬行、成人行走、老年拐杖。" }
  ],
  storyNodes: {
    start: { text:"你在霧林醒來，口袋裡只有一張地圖與一枚銅幣。前方有兩條路：左邊月光淡藍，右邊微風清鳴。",
      options:[ {t:"走向月光", go:"moon"}, {t:"追著清鳴", go:"wind"} ] },
    moon: { text:"月光映出一座古井。井旁刻著：「以當下之心，換未來之安。」",
      options:[ {t:"投入銅幣", go:"well"}, {t:"繞道離開", go:"camp"} ] },
    wind: { text:"風帶來遠處的笑聲，是旅人的營地。",
      options:[ {t:"前往營地", go:"camp"}, {t:"折返觀井", go:"moon"} ] },
    well: { text:"井中傳來回響：『規劃當下，方得從容。』你獲得【從容】屬性，旅途更穩定。",
      end:"恭喜，你以冷靜與規劃穿越迷霧，找到回家的路。" },
    camp: { text:"營火邊的旅人分享地圖標記：『別怕改變路線，只要保留餘裕。』",
      end:"你學會預留餘裕，旅程雖有波折卻安然抵達。" }
  },
  relax: {
    cycleSec: 8, // 吸氣 4s + 吐氣 4s
    tips: ["吸氣…","停…","吐氣…","停…"],
    durationSec: 60
  },
  puzzle: {
    symbols: ["🍀","⭐","🌙","🔥","💧","🍋","🧩","🎧","⚡","🌸"],
  }
};
</script>
<!-- ======================================================== -->

<script>
/* ===== Core Framework ===== */
const $ = (sel, el=document)=>el.querySelector(sel);
const mount = $("#mount");
const setText = (id, txt)=>{ const el = document.getElementById(id); if(el) el.textContent = txt; };
const setStatus = (txt)=> setText("footer-status", txt);
const setGenre = (t)=> setText("genre-pill", "模式：" + t);

function applyTheme(){
  if(CONFIG.palette?.bg) document.documentElement.style.setProperty('--bg', CONFIG.palette.bg);
  if(CONFIG.palette?.accent) document.documentElement.style.setProperty('--accent', CONFIG.palette.accent);
  setText("title", CONFIG.title || "遊戲模板");
  setText("subtitle", CONFIG.subtitle || "");
}

function clearMount(){ mount.innerHTML=""; }

/* ====== Games ====== */
// 1) Puzzle — 記憶翻牌
function gamePuzzle(){
  setGenre("益智（翻牌記憶）");
  clearMount();
  const wrap = document.createElement("div");
  wrap.className = "grid";
  const top = document.createElement("div"); top.className="card";
  const info = document.createElement("div"); info.innerHTML = "配對成功：<b id='okc'>0</b>";
  top.appendChild(info); wrap.appendChild(top);

  const board = document.createElement("div"); board.className="board";
  const pairs = CONFIG.difficulty==="hard"?10:CONFIG.difficulty==="easy"?6:8;
  const pool = CONFIG.puzzle.symbols.slice(0,pairs);
  const deck = [...pool, ...pool].sort(()=>Math.random()-0.5);
  const state = { first:null, lock:false, matched:0 };
  board.style.gridTemplateColumns = `repeat(${Math.sqrt(deck.length)%1?4:Math.sqrt(deck.length)}, 72px)`;

  deck.forEach((sym,i)=>{
    const t = document.createElement("button");
    t.className="tile"; t.dataset.i=i; t.dataset.sym=sym; t.textContent="❔";
    t.addEventListener("click", ()=>{
      if(state.lock || t.classList.contains("revealed")) return;
      t.classList.add("revealed"); t.textContent = sym;
      if(!state.first){ state.first = t; return; }
      // second
      if(state.first.dataset.sym===t.dataset.sym && state.first!==t){
        [state.first, t].forEach(e=>{ e.classList.add("matched"); e.style.pointerEvents="none"; });
        state.matched++; $("#okc").textContent = state.matched;
        if(state.matched===pairs){ setStatus("全部配對完成！"); }
        state.first=null;
      }else{
        state.lock=true;
        setTimeout(()=>{
          [state.first, t].forEach(e=>{ e.classList.remove("revealed"); e.textContent="❔"; });
          state.first=null; state.lock=false;
        }, 700);
      }
    });
    board.appendChild(t);
  });

  wrap.appendChild(board);
  mount.appendChild(wrap);
  setStatus("翻兩張找一對");
}

// 2) Riddle — 猜謎闖關
function gameRiddle(){
  setGenre("解謎（猜謎）");
  clearMount();
  const bank = CONFIG.riddleBank;
  let idx = 0, score = 0;
  const box = document.createElement("div"); box.className="grid";
  const qCard = document.createElement("div"); qCard.className="card";
  const p = document.createElement("div"); p.className="riddle-q";
  const opts = document.createElement("div");

  function render(){
    if(idx>=bank.length){
      box.innerHTML = `<div class="card big">完成！得分：${score}/${bank.length}</div>`;
      mount.appendChild(box); setStatus("闖關完成"); return;
    }
    const item = bank[idx];
    qCard.innerHTML = `<div class="riddle-q">第 ${idx+1}/${bank.length} 題：${item.q}</div>`;
    opts.innerHTML="";
    item.a.forEach((text, i)=>{
      const c = document.createElement("div");
      c.className="choice"; c.textContent = text;
      c.onclick = ()=>{
        const right = i===item.correct;
        c.classList.add(right?"correct":"wrong");
        if(right){ score++; setStatus("答對！" + (item.explain? " " + item.explain:"")); }
        else setStatus("再想想～ " + (item.explain? "提示："+item.explain:""));
        [...opts.children].forEach(n=>n.style.pointerEvents="none");
        setTimeout(()=>{ idx++; render(); }, 600);
      };
      opts.appendChild(c);
    });
    box.replaceChildren(qCard, opts);
    mount.appendChild(box);
  }
  render();
}

// 3) Story — 分支敘事
function gameStory(){
  setGenre("劇情（分支敘事）");
  clearMount();
  const nodes = CONFIG.storyNodes;
  let here = nodes.start;
  const card = document.createElement("div"); card.className="card story";
  function draw(){
    if(here.end){
      card.innerHTML = `<div>${here.text||""}</div><div class="big" style="margin-top:8px">${here.end}</div>`;
      setStatus("故事完結");
      mount.replaceChildren(card); return;
    }
    const opts = (here.options||[]).map(o=>`<button class="opt" style="margin-right:6px">${o.t}</button>`).join("");
    card.innerHTML = `<div>${here.text||""}</div><div style="margin-top:10px">${opts}</div>`;
    mount.replaceChildren(card);
    [...card.querySelectorAll(".opt")].forEach((b,i)=>{
      b.onclick=()=>{ here = nodes[here.options[i].go]; draw(); };
    });
    setStatus("做出你的選擇");
  }
  draw();
}

// 4) Relax — 呼吸節奏
function gameRelax(){
  setGenre("舒壓（呼吸引導）");
  clearMount();
  const wrap = document.createElement("div"); wrap.className="center grid";
  const bubble = document.createElement("div"); bubble.className="bubble center";
  const caption = document.createElement("div"); caption.className="hint"; caption.textContent="跟著圓球放大縮小吸吐氣";
  wrap.append(bubble, caption); mount.appendChild(wrap);

  const total = CONFIG.relax.durationSec||60;
  const step = (CONFIG.relax.cycleSec||8)/2; // 簡化：吸4s/吐4s
  let t = 0, grow=true;
  const timer = setInterval(()=>{
    t += 0.1;
    const scale = grow ? 1 + (t%step)/step*0.3 : 1.3 - (t%step)/step*0.3;
    bubble.style.transform = `scale(${scale})`;
    if(Math.floor(t)%step===0 && Math.abs((t%step)-0)<0.11){ grow=!grow; caption.textContent = grow? "吸氣…" : "吐氣…"; }
  }, 100);
  setTimeout(()=>{ clearInterval(timer); caption.textContent="完成一輪放鬆！"; setStatus("結束"); }, total*1000);
}

/* ===== Router ===== */
function start(){
  applyTheme();
  setText("subtitle", CONFIG.subtitle||"");
  $("#btn-restart").onclick = start;
  const map = { puzzle:gamePuzzle, riddle:gameRiddle, story:gameStory, relax:gameRelax };
  (map[CONFIG.gameType]||gamePuzzle)();
}
start();
</script>
</body>
</html>
